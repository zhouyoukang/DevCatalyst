# Windsurf Intelligence Pack — 两层架构设计

> 版本：v4.0 | 日期：2026-02-13
> 核心理念：通用层做一次，项目层模板化，一条提示词自建一切

## 架构概览

```
┌─────────────────────────────────────────────┐
│           Layer 1: 通用层（硬件）              │
│  跨所有项目生效，只需部署一次                    │
│                                             │
│  ┌─────────┐ ┌──────────┐ ┌──────────┐     │
│  │全局规则   │ │全局Skills │ │IDE设置    │     │
│  │PREDICT   │ │23个通用   │ │终端防卡   │     │
│  │ESCALATION│ │技能       │ │Shell集成  │     │
│  └─────────┘ └──────────┘ └──────────┘     │
└─────────────────────────────────────────────┘
                    ▼
┌─────────────────────────────────────────────┐
│           Layer 2: 项目层（软件）              │
│  每个项目独立配置，AI 自动适配                   │
│                                             │
│  ┌─────────┐ ┌──────────┐ ┌──────────┐     │
│  │项目规则   │ │项目Skills │ │项目工作流  │     │
│  │soul.md   │ │构建部署   │ │/dev 管线  │     │
│  │exec.md   │ │测试验证   │ │/review    │     │
│  └─────────┘ └──────────┘ └──────────┘     │
└─────────────────────────────────────────────┘
```

## Layer 1: 通用层

| 组件 | 位置 | 说明 |
|------|------|------|
| 全局规则 | `~/.codeium/windsurf/memories/global_rules.md` | AI 行为规则 |
| 全局 Skills | `~/.codeium/windsurf/skills/` | 23个通用开发技能 |
| IDE 设置 | `%APPDATA%/Windsurf/User/settings.json` | 终端防卡、Shell配置等 |
| Hooks | `~/.codeium/windsurf/hooks.json` | Python/Node.js可用，**PowerShell禁止** |

## Layer 2: 项目层

| 组件 | 位置 | 来源 |
|------|------|------|
| 项目规则 | `.windsurf/rules/` | 通用模板 + AI 适配 |
| 项目 Skills | `.windsurf/skills/` | AI 根据项目类型创建 |
| 工作流 | `.windsurf/workflows/` | 通用模板 + 项目命令 |
| AGENTS.md | 各目录 | AI 分析项目结构后创建 |
| 备份 | `.windsurf/backups/` | 自动创建 |

## 鲁棒性设计

- **中断恢复**：AI 被中断 → `/health-check` 自动检测缺失并恢复
- **配置鲁棒性**：规则文件缺失 → AI 从备份/模板/Memory 自动恢复
- **提示词鲁棒性**：模糊意图 → AI 重构意图 + 示范更好表达
- 每个部署步骤是**幂等的**：重复执行不会破坏已有配置
